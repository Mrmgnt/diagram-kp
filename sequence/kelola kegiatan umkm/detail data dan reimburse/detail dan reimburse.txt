@startuml
!theme materia

title Sequence Diagram - Approval Reimbursement Kegiatan UMKM (Pola MVC)
hide footbox

actor "Kantor Pusat" as Pengguna
boundary "Halaman_kelola_KegiatanUMKM" as Halaman_kelola_KegiatanUMKM
control "Controller" as Controller
entity "Entity" as Entity

Pengguna -> Halaman_kelola_KegiatanUMKM: Membuka menu "Kelola Kegiatan UMKM"
activate Halaman_kelola_KegiatanUMKM

Halaman_kelola_KegiatanUMKM -> Controller: Minta daftar kegiatan (status "Requested")
activate Controller

Controller -> Entity: Panggil fungsi getKegiatanByStatus("Requested")
activate Entity
Entity -> Entity: Mengambil daftar kegiatan dari database
Entity --> Controller: Mengembalikan daftar kegiatan
deactivate Entity

Controller --> Halaman_kelola_KegiatanUMKM: Meneruskan daftar kegiatan
deactivate Controller

Halaman_kelola_KegiatanUMKM --> Pengguna: Menampilkan daftar kegiatan
deactivate Halaman_kelola_KegiatanUMKM

Pengguna -> Halaman_kelola_KegiatanUMKM: Memilih kegiatan & klik "Detail Pengajuan"
activate Halaman_kelola_KegiatanUMKM

Halaman_kelola_KegiatanUMKM -> Controller: Minta detail kegiatan (berdasarkan ID)
activate Controller
Controller -> Entity: Panggil fungsi getDetailKegiatan(ID)
activate Entity
Entity --> Controller: Mengembalikan detail kegiatan
deactivate Entity
Controller --> Halaman_kelola_KegiatanUMKM: Meneruskan detail kegiatan
deactivate Controller

Halaman_kelola_KegiatanUMKM --> Pengguna: Menampilkan detail & tombol aksi ("Setujui", "Tolak")
deactivate Halaman_kelola_KegiatanUMKM

alt "Setujui" diklik
    Pengguna -> Halaman_kelola_KegiatanUMKM: Klik tombol "Setujui"
    activate Halaman_kelola_KegiatanUMKM
    Halaman_kelola_KegiatanUMKM -> Controller: Minta persetujuan kegiatan (ID)
    activate Controller
    Controller -> Entity: Panggil fungsi updateStatus(ID, "Approved")
    activate Entity
    Entity -> Entity: Memperbarui status di database
    Entity --> Controller: Konfirmasi status diperbarui
    deactivate Entity
    Controller --> Halaman_kelola_KegiatanUMKM: Respon sukses
    deactivate Controller
    Halaman_kelola_KegiatanUMKM --> Pengguna: Notifikasi "Reimbursement telah disetujui" & perbarui daftar
    deactivate Halaman_kelola_KegiatanUMKM
else "Tolak" diklik
    Pengguna -> Halaman_kelola_KegiatanUMKM: Klik tombol "Tolak"
    activate Halaman_kelola_KegiatanUMKM
    Halaman_kelola_KegiatanUMKM --> Pengguna: Menampilkan input alasan penolakan
    deactivate Halaman_kelola_KegiatanUMKM

    Pengguna -> Halaman_kelola_KegiatanUMKM: Mengisi alasan & konfirmasi penolakan
    activate Halaman_kelola_KegiatanUMKM
    Halaman_kelola_KegiatanUMKM -> Controller: Minta penolakan kegiatan (ID, alasan)
    activate Controller
    Controller -> Entity: Panggil fungsi updateStatus(ID, "Declined", alasan)
    activate Entity
    Entity -> Entity: Memperbarui status & menyimpan alasan di database
    Entity --> Controller: Konfirmasi status diperbarui
    deactivate Entity
    Controller --> Halaman_kelola_KegiatanUMKM: Respon sukses
    deactivate Controller
    Halaman_kelola_KegiatanUMKM --> Pengguna: Notifikasi "Reimbursement telah ditolak" & perbarui daftar
    deactivate Halaman_kelola_KegiatanUMKM
end

@enduml
